version 3.0
Intergrate the before-overlapping and after-overlapping.
